---

- name: Install common packages
  shell: |
    {{ ansible_pkg_mgr }} -y install {{ packages | join(' ') }}
    {{ ansible_pkg_mgr }} -y install {{ common | join(' ') }}
  when: item not in installed_packages
  with_items:
    - "{{ packages }}"
    - "{{ common }}"
  tags: ['packages']

- include: sudoers.yml
  tags: ['sudoers']

- include: zsh.yml
  tags: ['zsh']

- include: gemrc.yml
  tags: ['ruby']

- include: filesystem.yml
  tags: ['filesystem']

- include: perms.yml
  tags: ['perms']

- include: autofs.yml
  tags: ['autofs']
  when: autofs_client|bool

- include: nfs.yml
  tags: ['nfs']
  when: nfshost|bool

- include: grub.yml
  tags: ['grub']

- include: nvim.yml
  tags: ['nvim']
  when: nvim|bool

- include: atom.yml
  tags: ['atom']

- include: timeshift.yml
  tags: ['timeshift']
  when: timeshift|bool

- include: ripgrep.yml
  tags: ['ripgrep']
  when: rga|bool

- include: googler.yml
  tags: ['googler']
  when: googler|bool

- include: chrome.yml
  tags: ['chrome']
  when: chrome|bool
