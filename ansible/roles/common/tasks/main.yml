---

- include: sudoers.yml
  tags: ['sudoers']

- include: rtkernel.yml
  tags: ['rtkernel']
  when: kernel is defined

- name: set packages to install
  set_fact:
    _packages: "{{ (packages + common)|difference(installed_packages) }}"
  tags: ['packages']

- name: Install common packages
  shell: "{{ ansible_pkg_mgr }} -y install {{ _packages| join(' ') }}"
  when: _packages | length > 0
  tags: ['packages']

- include: realtime.yml
  tags: ['realtime']

- include: filesystem.yml
  tags: ['filesystem']

- include: perms.yml
  tags: ['perms']

- include: autofs.yml
  tags: ['autofs']
  when: autofs_client|bool

- include: nfs.yml
  tags: ['nfs']
  when: nfs_host|bool

- include: timeshift.yml
  tags: ['timeshift']
  when: install_timeshift|bool

- include: zsh.yml
  tags: ['zsh']

- include: nvim.yml
  tags: ['nvim']
  when: install_nvim|bool

- include: ripgrep.yml
  tags: ['ripgrep']
  when: install_rga|bool

- include: googler.yml
  tags: ['googler']
  when: install_googler|bool

- include: atom.yml
  tags: ['atom']
  when: install_atom|bool

- include: chrome.yml
  tags: ['chrome']
  when: install_chrome|bool
