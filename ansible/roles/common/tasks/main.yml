---

- include: sudoers.yml
  tags: ['sudoers']

- include: rtkernel.yml
  tags: ['rtkernel']

- name: set packages to install
  set_fact:
    _packages: "{{ (packages + common)|difference(installed_packages) }}"
  tags: ['packages']

- name: Install common packages
  shell: "{{ ansible_pkg_mgr }} -y install {{ _packages| join(' ') }}"
  when: _packages | length > 0
  tags: ['packages']

- include: zsh.yml
  tags: ['zsh']

- include: gemrc.yml
  tags: ['ruby']

- include: filesystem.yml
  tags: ['filesystem']

- include: perms.yml
  tags: ['perms']

- include: autofs.yml
  tags: ['autofs']
  when: autofs_client|bool

- include: nfs.yml
  tags: ['nfs']
  when: nfshost|bool

- include: grub.yml
  tags: ['grub']

- include: nvim.yml
  tags: ['nvim']
  when: nvim|bool

- include: atom.yml
  tags: ['atom']

- include: timeshift.yml
  tags: ['timeshift']
  when: timeshift|bool

- include: ripgrep.yml
  tags: ['ripgrep']
  when: rga|bool

- include: googler.yml
  tags: ['googler']
  when: googler|bool

- include: chrome.yml
  tags: ['chrome']
  when: chrome|bool
