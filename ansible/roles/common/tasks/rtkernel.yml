---

- name: install rt-kernel
  shell: "{{ ansible_pkg_mgr }} -y install {{ kernel | join(' ') }}"
  when: item not in installed_packages
  with_items:
    - "{{ kernel }}"
  register: rtkernel
  tags: ['kernel']

- name: Reboot if a different kernel was installed
  command: shutdown -r now
  when: rtkernel.changed
  async: 90
  poll: 5
