---

- name: check if the grub.cfg is in /boot/grub2
  stat: path="/boot/grub2/grub.cfg"
  register: hazigrub
  check_mode: no

- name: push default grub file
  template:
    src: etc/default/grub.j2
    dest: /etc/default/grub
    owner: root
    group: root
    mode: '644'
    backup: yes
  tags: ['grub']
  register: result

#TODO: dynamically set grub cfg location
- name: reload grub
  shell: |
    grub2-mkconfig -o {{ grub_cfg }}
  when: "ansible_facts['os_family'] == 'RedHat' and result.changed"
