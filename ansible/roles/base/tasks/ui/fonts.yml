---
#https://gist.github.com/YoEight/d19112db56cd8f93835bf2d009d617f7

- name: check if local fonts exists
  stat: path="/usr/local/share/fonts/Feather.ttf"
  register: hazilocalfonts

- name: Extract fonts to /usr/local/share/fonts
  unarchive:
    src: usr/local/share/fonts.tar.gz
    dest: "/usr/local/share/"
  when: not hazilocalfonts.stat.exists

- name: update fontconfig
  template:
    src: etc/fonts/local.conf.j2
    dest: "/etc/fonts/local.conf"
    owner: root
    group: root
    mode: '644'
    backup: no

- name: enable fontconfig presets
  file:
    src: "/usr/share/fontconfig/conf.avail/{{ item }}"
    dest: "/etc/fonts/conf.d/{{ item }}"
    owner: root
    group: root
    state: link
  with_items:
    - 10-sub-pixel-rgb.conf
    - 70-no-bitmaps.conf

- name: Update font-cache
  command: fc-cache -r
  register: font_cache
  changed_when: font_cache.rc != 0
