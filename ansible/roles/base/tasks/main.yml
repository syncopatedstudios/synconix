---

- name: starting base role
  debug:
    msg: "starting base role"

- name: Include OS-specific variables.
  include_vars: "{{ ansible_os_family }}.yml"

- name: Include OS-specific tasks
  include: "distros/{{ ansible_os_family }}.yml"

- include: sudoers.yml
  tags: ['sudoers']

- include: packages.yml
  tags: ['packages']

- include: network.yml
  when: ansible_lsb['id'] != 'Manjaro-ARM'
  tags: ['network']

- name: check if firewalld is present
  shell: command -v firewalld
  register: hazifirewalld
  changed_when: hazifirewalld.rc != 0
  check_mode: no
  ignore_errors: yes

- include: firewalld.yml
  tags: ['firewall']
  when: not hazifirewalld.rc != 0

- include: zsh.yml
  tags: ['zsh']

- include: dots.yml
  tags: ['dots']

- include: ssh.yml
  tags: ['ssh']

- include: ntp.yml
  tags: ['ntp']

- include: ruby.yml
  tags: ['ruby']

- include: nfs.yml
  when: nfs_host is defined
  tags: ['nfs']

- include: autofs.yml
  when: autofs_client is defined
  tags: ['autofs']

- include: rsyncd.yml
  when: rsyncd_host is defined
  tags: ['rsyncd']

- include: docker.yml
  when: docker_host|bool
  tags: ['docker']

- include: libvirt.yml
  when: kvm_host|bool
  tags: ['libvirt']

# - include: backups.yml
#   tags: ['backups']

- include: updatedb.yml
  tags: ['updatedb']

- include: audio.yml
  when: inventory_hostname in groups['daw']
  tags: ['audio']

- include: ui.yml
  when: graphical_target|bool
  tags: ['ui']
