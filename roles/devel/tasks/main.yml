---

- name: gather facts
  setup:
    gather_subset:
      - os_family
      - pkg_mgr

- name: Include OS-specific variables.
  include_vars: "{{ ansible_os_family }}.yml"

- name: set packages to install
  set_fact:
    _packages: "{{ (development.base + development.ruby)  }}"
  tags: ['packages']

- name: Ensure all the required packages are installed
  import_role:
    name: pkg_manager
  vars:
    pkg_state: present
  tags: ['packages']

- include: ruby.yml
  tags: ['ruby']

- include: libvirt.yml
  when: kvm_host|bool and libvirt is defined
  tags: ['libvirt']
