---

- name: remove current alsa modprobe options
  file:
    path: /etc/modprobe.d/10-alsa_usb.conf
    state: absent
  ignore_errors: True

- name: check to see if alsa modprobe mod file exists
  stat: path="/etc/modprobe.d/10-alsa_usb.conf"
  register: hazimodprobe
  tags: ['modprobe']

- name: Add modprobe option to not use a usb card are the default device
  lineinfile:
    path: /etc/modprobe.d/10-alsa_usb.conf
    line: "options snd slots=snd-hda-intel,snd-usb-audio"
    create: yes
  when: not hazimodprobe.stat.exists
  tags: ['modprobe']
