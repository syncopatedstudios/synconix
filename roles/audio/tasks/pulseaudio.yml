---

- name: remove pulseaudio
  shell: |
    yay -R pulseaudio pulseaudio-jack --noconfirm
  become: True
  become_user: "{{ user.name }}"
  register: remove_pulse
  failed_when: "'error: target not found' not in remove_pulse.stderr"
  changed_when: remove_pulse.rc == 0
  tags: ['pulseaudio']

- name: Remove pulseaudio systemd configs
  file:
    path: "{{ item }}"
    state: absent
  with_items:
    - /usr/lib/systemd/user/pulseaudio.service
    - /usr/lib/systemd/user/pulseaudio.socket
    - /usr/lib/systemd/user/pulseaudio-x11.service
