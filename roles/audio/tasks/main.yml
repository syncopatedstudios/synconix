---

- name: gather facts
  setup:
    gather_subset:
      - os_family
      - pkg_mgr

- name: Include OS-specific variables.
  include_vars: "{{ ansible_os_family }}.yml"

- include: filesystem.yml
  tags: ['filesystem']


- include: soundservices.yml
  tags: ['audio', 'alsa', 'jack', 'pulseaudio', pipewire]

- name: Set base packages to install
  set_fact:
    _packages: "{{ base }}"
  tags: ['packages']

- name: Install base packages
  import_role:
    name: pkg_manager
  vars:
    pkg_state: present

- include: utils.yml
  when: install_audio_utils|bool
  tags: ['audio']

- include: plugins.yml
  when: install_audio_plugins|bool
  tags: ['audio']
